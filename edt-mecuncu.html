<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../core-tooltip/core-tooltip.html">
<link rel="import" href="../core-icons/core-icons.html">
<link rel="import" href="../core-collapse/core-collapse.html">
<link rel="import" href="../paper-shadow/paper-shadow.html">
<link rel="import" href="../core-toolbar/core-toolbar.html">
<link rel="import" href="../paper-button/paper-button.html">
<link rel="import" href="../core-icons/social-icons.html">
<link rel="import" href="../core-dropdown-menu/core-dropdown-menu.html">

<link rel="import" href="scripts.html">

<script src="timeplot.js"></script>

<polymer-element name="edt-mecuncu" attributes="days types typeSelected subtypes subtypeSelected">
	<template>
	
	<link rel="stylesheet" href="edt-mecuncu.css">
	
	<div id="edt">
		<div horizontal layout center>
				<div><img class="edt-logo" src="images/mecuncu.png" alt="Logo Asociacion"/></div>
				<div class="edt-caption" flex>EDT - MecUncu</div>
		</div>
		<div>
			<paper-shadow id="edt_shadow" z="2"></paper-shadow>
			<core-toolbar id="searchBar" layout horizontal center center-justified>
				<core-dropdown-menu id="selectType" label="Elija tipo" on-core-activate="{{typeClicked}}">
					<template repeat="{{types}}">
						<core-item icon="{{icon}}" label="{{type}}">
					</template>
				</core-dropdown-menu>
				<core-dropdown-menu id="selectWhich" label="Elija {{typeSelected.label}}" on-core-activate="{{subTypeClicked}}" hidden>
					<template repeat="{{subtypes}}">
						<core-item label="{{}}">
					</template>
				</core-dropdown-menu>
				<core-item id="which" icon="{{typeSelected.icon}}" label="{{subTypeSelected.label}}" hidden></core-item>
				<paper-button id="clearSearchBtn" on-click="{{clearSearch}}" hidden>
					<core-icon icon="clear"></core-icon>
				</paper-button>
			</core-toolbar>
			<table id="tabla">
				<thead class="edt-head">
					<th class="edt-head-wrap">Día</td>
					<th class="edt-head-time-h" id="Hora">Hora</td>
				</thead>			
				<tbody>
					<template repeat="{{ days }}">
						<tr>
							<td class="edt-days"><span id="{{}}" on-click="{{showTimesV}}">{{}}</span>
							<core-collapse id="{{}}Collapse">
								<div class="chartContainerV" id="{{}}V"></div>
							</core-collapse></td>
							<td class="edt-times-h">
								<div class="chartContainer" id="{{}}H"></div>
							</td>
						</tr>
					</template>
				</tbody>
				
			</table>
		</div>
		<div><p class="edt-footer">Asociación de Mecatrónica de Mendoza</p></div>
	</div>
	</template>
	<script>
	
		window.addEventListener('polymer-ready', function(e) {
				document.getElementsByTagName('edt-mecuncu')[0].plot();		
		});
		
		Polymer({
			ready: function(){
				$(window).on('resize', function() {					
					clearplot();
					replot();
				});
				
				this.days = ['Lunes', 'Martes', 'Miercoles', 'Jueves', 'Viernes'];
				
				this.subtypes = ['Anibal Mirasso','Susana Bernasconi','Alfredo Puglesi'];
				
				this.types = [	{	type:'Profesor',
									icon:'social:school'
								},
								{	type:'Estudiante',
									icon:'social:person'
								},
								{	type:'Materia',
									icon:'icons:folder'
								}];
								
				this.config = {	types:	{
								Clase: {
									color:'#B1C3F9'
								},
								Plenaria: {
									color:'#9EE874'
								},
								Curso: {
									color: '#FFED70'
								},
								Examen: {
									color: '#9F8186'
								},
								TP: {
									color: '#FF8680'
								}
							},
							limits:	{
								start:'08h00',
								end:'22h00'
							}
						 };
						
			this.timesM = [	{	ti:'14h30',
								tf:'16h48',
								place:'Aula 10',
								person:'Alvaro Alonso',
								type:'Clase'
							},
							{	ti:'17h00',
								tf:'18h00',
								place:'Aula 1',
								person:'Gino Copparoni',
								type:'TP'
							},
							{	ti:'08h40',
								tf:'09h50',
								place:'Aula 16',
								person:'Franco Ardiani',
								type:'Plenaria'
							},
							{	ti:'18h30',
								tf:'21h50',
								place:'Asociación de Mecatrónica',
								person:'Fernando Cladera',
								type:'Curso'
							},
							{	ti:'11h00',
								tf:'11h45',
								place:'Aula 5',
								person:'Maximiliano Badaloni',
								type:'Examen'
							}];
							
			this.timesT = [	{	ti:'12h30',
								tf:'13h48',
								place:'Aula 6',
								person:'Andrés Manelli',
								type:'Curso'
							},
							{	ti:'08h10',
								tf:'10h20',
								place:'Anfiteatro Oeste',
								person:'Aníbal Mirasso',
								type:'Clase'
							},
							{	ti:'15h00',
								tf:'16h30',
								place:'Asociación de Mecatrónica',
								person:'Fernando Cladera',
								type:'Curso'
							},
							{	ti:'19h00',
								tf:'20h00',
								place:'Anfiteatro Este',
								person:'Susana Bernasconi',
								type:'Plenaria'
							}];
			
			this.times =  [	{	day:'Martes',
								times:this.timesT
							},
							{	day:'Lunes',
								times:this.timesM
							}];
			},	
			showTimesV: function(event, detail, sender) {
				this.$.edt.querySelector('#'+sender.id+'Collapse').toggle();
			},
			plot: function(){
				timeplot(this.times,this.config);
			},
			typeClicked: function(event, detail, sender){
				this.typeSelected=detail.item;
				$(this.$.selectType).prop('hidden',true);
				$(this.$.selectWhich).prop('hidden',false);
				$(this.$.clearSearchBtn).prop('hidden',false);
			},
			clearSearch: function(event, detail, sender){
				$(this.$.selectType).prop('hidden',false);
				$(this.$.which).prop('hidden',true);
				$(this.$.selectWhich).prop('hidden',true);
				$(this.$.clearSearchBtn).prop('hidden',true);
			},
			subTypeClicked: function(event, detail, sender){
				this.subTypeSelected=detail.item;
				$(this.$.which).prop('hidden',false);
				$(this.$.selectWhich).prop('hidden',true);
			}
		});
	</script>
</polymer-element>
